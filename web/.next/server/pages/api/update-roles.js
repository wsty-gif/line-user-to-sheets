"use strict";(()=>{var e={};e.id=214,e.ids=[214],e.modules={9993:e=>{e.exports=require("googleapis")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7536:(e,s,a)=>{a.r(s),a.d(s,{config:()=>d,default:()=>l,routeModule:()=>i});var t={};a.r(t),a.d(t,{default:()=>handler});var r=a(1802),o=a(7153),n=a(6249),u=a(9993);async function handler(e,s){if("POST"!==e.method)return s.status(405).json({success:!1,message:"Method not allowed"});try{let{users:a}=e.body;if(!a||!Array.isArray(a))return s.status(400).json({success:!1,message:"Invalid request body"});let t=new u.google.auth.GoogleAuth({credentials:{client_email:process.env.GOOGLE_CLIENT_EMAIL,private_key:process.env.GOOGLE_PRIVATE_KEY?.replace(/\\n/g,"\n")},scopes:["https://www.googleapis.com/auth/spreadsheets"]}),r=u.google.sheets({version:"v4",auth:t}),o=process.env.SPREADSHEET_ID,n=await r.spreadsheets.values.get({spreadsheetId:o,range:"Sheet1!B2:B"}),l=n.data.values||[],d=a.map(e=>{let s=l.findIndex(s=>s[0]===e.name);if(-1===s)return null;let a=`Sheet1!F${s+2}`;return{range:a,values:[[e.role]]}}).filter(Boolean);if(0===d.length)return s.status(400).json({success:!1,message:"No matching users found"});await r.spreadsheets.values.batchUpdate({spreadsheetId:o,requestBody:{valueInputOption:"RAW",data:d}}),s.status(200).json({success:!0,message:"Roles updated successfully"})}catch(e){console.error(e),s.status(500).json({success:!1,message:"Internal Server Error"})}}let l=(0,n.l)(t,"default"),d=(0,n.l)(t,"config"),i=new r.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/update-roles",pathname:"/api/update-roles",bundlePath:"",filename:""},userland:t})}};var s=require("../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[222],()=>__webpack_exec__(7536));module.exports=a})();