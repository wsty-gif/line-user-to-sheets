"use strict";(()=>{var e={};e.id=912,e.ids=[912],e.modules={2261:e=>{e.exports=require("@line/bot-sdk")},9993:e=>{e.exports=require("googleapis")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1780:(e,r,s)=>{s.r(r),s.d(r,{config:()=>d,default:()=>c,routeModule:()=>l});var t={};s.r(t),s.d(t,{default:()=>handler});var n=s(1802),o=s(7153),u=s(6249),a=s(2261),i=s(135);async function handler(e,r){try{let{botName:s,userId:t}=e.query;if(!s||"string"!=typeof s)return r.status(400).json({success:!1,error:"botName is required"});if(!t||"string"!=typeof t)return r.status(400).json({success:!1,error:"userId is required"});let n=function(e){switch(e){case"株式会社TETOTE":return 1;case"mokara bridal etc.":return 3;default:throw Error(`Unknown botName: ${e}`)}}(s),o=function(e){let r=process.env[`CHANNEL_ACCESS_TOKEN_${e}`],s=process.env[`CHANNEL_SECRET_${e}`];if(!r||!s)throw Error(`Channel token/secret not found for account ${e}`);return new a.Client({channelAccessToken:r,channelSecret:s})}(n),u=await (0,i.R)(),c=u.find(e=>e.userId===t);if(!c)return r.status(404).json({success:!1,error:"User not found"});let d="admin"===c.role?process.env[`ADMIN_RICHMENU_ID_${n}`]:process.env[`USER_RICHMENU_ID_${n}`];if(!d)throw Error(`RichMenu ID not found for account ${n}, role ${c.role}`);return await o.linkRichMenuToUser(t,d),r.status(200).json({success:!0,richMenuId:d})}catch(e){return console.error(e),r.status(500).json({success:!1,error:e.message})}}let c=(0,u.l)(t,"default"),d=(0,u.l)(t,"config"),l=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/set-richmenu",pathname:"/api/set-richmenu",bundlePath:"",filename:""},userland:t})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[222,135],()=>__webpack_exec__(1780));module.exports=s})();